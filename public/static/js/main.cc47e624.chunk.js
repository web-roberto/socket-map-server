(this["webpackJsonpmapas-app"]=this["webpackJsonpmapas-app"]||[]).push([[0],{37:function(e,t,n){},61:function(e,t){},64:function(e,t,n){"use strict";n.r(t);var c=n(1),o=n(0),a=n(30),r=n.n(a),u=(n(37),n(8)),i=n(31),s=n.n(i),f=Object(o.createContext)(),l=function(e){var t=e.children,n=function(e){var t=Object(o.useMemo)((function(){return s.a.connect(e)}),[e]),n=Object(o.useState)(!1),c=Object(u.a)(n,2),a=c[0],r=c[1];return Object(o.useEffect)((function(){r(t.connected)}),[t]),Object(o.useEffect)((function(){t.on("connect",(function(){return r(!0)}))}),[t]),Object(o.useEffect)((function(){t.on("disconnect",(function(){return r(!1)}))}),[t]),{socket:t,online:a}}("https://socket-map.herokuapp.com/"),a=n.socket,r=n.online;return Object(c.jsx)(f.Provider,{value:{socket:a,online:r},children:t})},d=n(9),b=n.n(d),j=n(68),O=n(67);b.a.accessToken="pk.eyJ1Ijoia2xlcml0aCIsImEiOiJja2dzOHdteDkwM2tnMndxMWhycnY3Ymh3In0.Zis8hP6HuwcywtgUhfeZoQ";var m={lng:-122.4725,lat:37.801,zoom:13.5},v=function(){var e=function(e){var t=Object(o.useRef)(),n=Object(o.useCallback)((function(e){t.current=e}),[]),c=Object(o.useRef)({}),a=Object(o.useRef)(new O.a),r=Object(o.useRef)(new O.a),i=Object(o.useRef)(),s=Object(o.useState)(e),f=Object(u.a)(s,2),l=f[0],d=f[1],m=Object(o.useCallback)((function(e,t){var n=e.lngLat||e,o=n.lng,u=n.lat,s=new b.a.Marker;s.id=null!==t&&void 0!==t?t:Object(j.a)(),s.setLngLat([o,u]).addTo(i.current).setDraggable(!0),c.current[s.id]=s,t||r.current.next({id:s.id,lng:o,lat:u}),s.on("drag",(function(e){var t=e.target,n=t.id,c=t.getLngLat(),o=c.lng,r=c.lat;a.current.next({id:n,lng:o,lat:r})}))}),[]),v=Object(o.useCallback)((function(e){var t=e.id,n=e.lng,o=e.lat;c.current[t].setLngLat([n,o])}),[]);return Object(o.useEffect)((function(){var n=new b.a.Map({container:t.current,style:"mapbox://styles/mapbox/streets-v11",center:[e.lng,e.lat],zoom:e.zoom});i.current=n}),[e]),Object(o.useEffect)((function(){var e;null===(e=i.current)||void 0===e||e.on("move",(function(){var e=i.current.getCenter(),t=e.lng,n=e.lat;d({lng:t.toFixed(4),lat:n.toFixed(4),zoom:i.current.getZoom().toFixed(2)})}))}),[]),Object(o.useEffect)((function(){var e;null===(e=i.current)||void 0===e||e.on("click",m)}),[m]),{agregarMarcador:m,actualizarPosicion:v,coords:l,marcadores:c,nuevoMarcador$:r.current,movimientoMarcador$:a.current,setRef:n}}(m),t=e.setRef,n=e.coords,a=e.nuevoMarcador$,r=e.movimientoMarcador$,i=e.agregarMarcador,s=e.actualizarPosicion,l=Object(o.useContext)(f).socket;return Object(o.useEffect)((function(){l.on("marcadores-activos",(function(e){for(var t=0,n=Object.keys(e);t<n.length;t++){var c=n[t];i(e[c],c)}}))}),[l,i]),Object(o.useEffect)((function(){a.subscribe((function(e){l.emit("marcador-nuevo",e)}))}),[a,l]),Object(o.useEffect)((function(){r.subscribe((function(e){l.emit("marcador-actualizado",e)}))}),[l,r]),Object(o.useEffect)((function(){l.on("marcador-actualizado",(function(e){s(e)}))}),[l,s]),Object(o.useEffect)((function(){l.on("marcador-nuevo",(function(e){i(e,e.id)}))}),[l,i]),Object(c.jsxs)(c.Fragment,{children:[Object(c.jsxs)("div",{className:"info",children:["Lng: ",n.lng," | lat: ",n.lat," | zoom: ",n.zoom]}),Object(c.jsx)("div",{ref:t,className:"mapContainer"})]})},g=function(){return Object(c.jsx)(l,{children:Object(c.jsx)(v,{})})};r.a.render(Object(c.jsx)(g,{}),document.getElementById("root"))}},[[64,1,2]]]);
//# sourceMappingURL=main.cc47e624.chunk.js.map